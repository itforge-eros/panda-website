{"version":3,"sources":["search-page.js"],"names":["monthsTH","weekdaysTH","monthsEN","weekdaysEN","apiURL","trySamples","Vue","component","props","template","app","el","data","s_quick","s_date","Date","s_date_raw","s_faculty","s_type","s_capacity","firstSearch","showAdvanced","searchResults","loading","methods","toggleAdvanced","doSearch","length","document","getElementById","remove","axios","method","query","then","result","searchSpaces","catch","err","console","log","setRawDate","date","m","getMonth","d","getDate","getFullYear","today","picker","Pikaday","field","i18n","previousMonth","nextMonth","months","weekdays","weekdaysShort","firstDay","format","minDate","maxDate","yearRange","onClose","value","toString","day","split","month","weekday","monthsMapper","element","weekdaysMapper","findIndex"],"mappings":"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","file":"search-page.js","sourcesContent":["var monthsTH = ['ม.ค.','ก.พ.','มี.ค','เม.ย.','พ.ค.','มิ.ย','ก.ค.','ส.ค.','ก.ย.','ต.ค.','พ.ย.','ธ.ค.'];\nvar weekdaysTH = ['อา.','จ.','อ.','พ.','พฤ.','ศ.','ส.'];\nvar monthsEN = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\nvar weekdaysEN = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];\n\nconst apiURL = \"https://api.space.itforge.io/graphql\";\nconst trySamples = [\"M03 IT\", \"Auditorium\", \"อาคารเรียนรวม\"];\n\nVue.component(\"result-card\", {\n\tprops: [\"slug\", \"name\", \"dept\", \"deptSlug\", \"capacity\", \"amenities\"],\n\ttemplate: \"#result-card\"\n});\n\nVue.component(\"spinner\", {\n\ttemplate: `<div class=\"spinner\" style=\"margin-top: 4em\"></div>`\n});\n\nvar app = new Vue({\n\tel: \"#app\",\n\tdata: {\n\t\ts_quick: \"\",\n\t\ts_date: new Date(),\n\t\ts_date_raw: \"\",\n\t\ts_faculty: \"\",\n\t\ts_type: \"\",\n\t\ts_capacity: \"\",\n\t\tfirstSearch: true,\n\t\tshowAdvanced: false,\n\t\ttrySamples: trySamples,\n\t\tsearchResults: [],\n\t\tloading: false\n\t},\n\tmethods: {\n\t\ttoggleAdvanced: function() {\n\t\t\tthis.showAdvanced\n\t\t\t\t? (this.s_faculty = \"\")\n\t\t\t\t: (this.s_faculty = \"fac-it\");\n\t\t\tthis.showAdvanced\n\t\t\t\t? (this.s_type = \"\")\n\t\t\t\t: (this.s_type = \"1\");\n\t\t\tthis.showAdvanced = !this.showAdvanced;\n\t\t},\n\t\tdoSearch: function() {\n\t\t\tthis.searchResults.length = 0;\n\t\t\tthis.loading = true;\n\t\t\tif (this.firstSearch) {\n\t\t\t\tdocument.getElementById(\"page-title\").remove();\n\t\t\t\tdocument.getElementById(\"labels\").remove();\n\t\t\t\tdocument.getElementById(\"search-house\").remove();\n\t\t\t\tthis.firstSearch = false;\n\t\t\t}\n\t\t\taxios(apiURL, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdata: {\n\t\t\t\t\tquery: `\n\t\t\t\t\t\tquery {\n\t\t\t\t\t\t\tsearchSpaces(name: \"${app.s_quick}\") {\n\t\t\t\t\t\t\t\tid name fullName capacity\n\t\t\t\t\t\t\t\tdepartment {name fullThaiName}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t`\n\t\t\t\t}\n\t\t\t})\n\t\t\t\t.then(function(result) {\n\t\t\t\t\tapp.searchResults = result.data.data.searchSpaces;\n\t\t\t\t\tapp.loading = false;\n\t\t\t\t})\n\t\t\t\t.catch(function(err) {\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\tapp.loading = false;\n\t\t\t\t});\n\t\t}\n\t}\n});\n\nfunction setRawDate(date) {\n\t// create a raw date for sending to the API (eg. 2018-04-14)\n\tvar m = date.getMonth() + 1;\n\tvar d = date.getDate();\n\treturn (\n\t\tdate.getFullYear() + \"-\" + (m < 10 ? \"0\" + m : m) + \"-\" + (d < 10 ? \"0\" + d : d)\n\t);\n}\n\nconst today = new Date();\n\nvar picker = new Pikaday({\n\tfield: document.getElementById(\"datepicker\"),\n\ti18n: {\n\t\tpreviousMonth: 'เดือนที่แล้ว',\n\t\tnextMonth: 'เดือนหน้า',\n\t\tmonths: ['มกราคม','กุมภาพันธ์','มีนาคม','เมษายน','พฤษภาคม','มิถุนายน','กรกฎาคม','สิงหาคม','กันยายน','ตุลาคม','พฤศจิกายน','ธันวาคม'],\n\t\tweekdays: ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],\n\t\tweekdaysShort: ['อา.','จ.','อ.','พ.','พฤ.','ศ.','ส.']\n\t},\n\tfirstDay: 1,\n\tformat: \"DD-MM-YYYY\",\n\tminDate: today,\n\tmaxDate: new Date(\n\t\ttoday.getFullYear() + 1,\n\t\ttoday.getMonth(),\n\t\ttoday.getDate()\n\t),\n\tyearRange: [today.getFullYear(), today.getFullYear() + 1],\n\tonClose: function() {\n\t\tapp.s_date = document.getElementById(\"datepicker\").value;\n\t\tapp.s_date_raw = setRawDate(picker.getDate());\n\t},\n\ttoString(date) {\n\t\tconst day = date.toString().split(\" \")[2];\n\t\tconst month = date.toString().split(\" \")[1];\n\t\tconst weekday = date.toString().split(\" \")[0];\n\t\tfunction monthsMapper(element) {\n\t\t\treturn element == `${month}`;\n\t\t}\n\t\tfunction weekdaysMapper(element) {\n\t\t\treturn element == `${weekday}`;\n\t\t}\n\t\tapp.s_date = `${weekdaysTH[weekdaysEN.findIndex(weekdaysMapper)]}\\u0020${day}\\u0020${monthsTH[monthsEN.findIndex(monthsMapper)]}`;\n\t\treturn `${weekdaysTH[weekdaysEN.findIndex(weekdaysMapper)]}\\u0020${day}\\u0020${monthsTH[monthsEN.findIndex(monthsMapper)]}`;\n\t}\n});\n\napp.s_date_raw = setRawDate(picker.getDate()); // initial to present\n"]}