{"version":3,"sources":["single-page.js"],"names":["monthsTH","weekdaysTH","monthsEN","weekdaysEN","times","t","i","push","slot","time","apiURL","findMin_Max","min_time","Math","min","apply","app","chosenTimes","max_time","max","setSelected","j","document","getElementById","id","removeAttribute","setAttribute","setApiDate","date","m","getMonth","d","getDate","getFullYear","Vue","el","data","r_date","r_date_raw","Date","r_startTime","r_endTime","chosenSlots","submitText","spaceId","reportTitle","reportBody","reportToken","reportSent","submitHasError","methods","sendReport","axios","method","query","headers","then","console","log","result","catch","err","today","picker","Pikaday","field","i18n","previousMonth","nextMonth","months","weekdays","weekdaysShort","firstDay","minDate","maxDate","yearRange","onClose","value","toString","day","split","month","weekday","monthsMapper","element","weekdaysMapper","findIndex","timeToSlot","hr","parseInt","mn","isFirstTimeChoosing","$","clockTimePicker","precision","required","minimum","maximum","onAdjust","newVal","oldVal","endHr","endMn","val"],"mappings":";;AAAA,IAAMA,WAAW,CAAC,MAAD,EAAQ,MAAR,EAAe,MAAf,EAAsB,OAAtB,EAA8B,MAA9B,EAAqC,MAArC,EAA4C,MAA5C,EAAmD,MAAnD,EAA0D,MAA1D,EAAiE,MAAjE,EAAwE,MAAxE,EAA+E,MAA/E,CAAjB;AACA,IAAMC,aAAa,CAAC,KAAD,EAAO,IAAP,EAAY,IAAZ,EAAiB,IAAjB,EAAsB,KAAtB,EAA4B,IAA5B,EAAiC,IAAjC,CAAnB;AACA,IAAMC,WAAW,CAAC,KAAD,EAAO,KAAP,EAAa,KAAb,EAAmB,KAAnB,EAAyB,KAAzB,EAA+B,KAA/B,EAAqC,KAArC,EAA2C,KAA3C,EAAiD,KAAjD,EAAuD,KAAvD,EAA6D,KAA7D,EAAmE,KAAnE,CAAjB;AACA,IAAMC,aAAa,CAAC,KAAD,EAAO,KAAP,EAAa,KAAb,EAAmB,KAAnB,EAAyB,KAAzB,EAA+B,KAA/B,EAAqC,KAArC,CAAnB;;AAEA,IAAMC,QAAQ,EAAd;AACA,KAAK,IAAIC,IAAI,CAAR,EAAWC,IAAI,CAApB,EAAuBD,KAAK,IAA5B,EAAkCA,KAAG,GAAH,EAAQC,GAA1C;AAA+CF,OAAMG,IAAN,CAAW,EAACC,MAAMF,CAAP,EAAUG,MAAMJ,CAAhB,EAAX;AAA/C,CAEA,IAAMK,SAAS,sCAAf;;AAEA,SAASC,WAAT,GAAuB;AACtBC,YAAWC,KAAKC,GAAL,CAASC,KAAT,CAAe,IAAf,EAAqBC,IAAIC,WAAzB,CAAX;AACAC,YAAWL,KAAKM,GAAL,CAASJ,KAAT,CAAe,IAAf,EAAqBC,IAAIC,WAAzB,CAAX;AACA;AACD,SAASG,WAAT,GAAwB;AACvB,MAAK,IAAIC,IAAIT,QAAb,EAAuBS,KAAMH,QAA7B,EAAwCG,KAAG,GAA3C,EAAgD;AAC/CC,WAASC,cAAT,CAAwBC,KAAG,UAAUH,CAArC,EAAwCI,eAAxC,CAAwD,OAAxD;AACAH,WAASC,cAAT,CAAwBC,KAAG,UAAUH,CAArC,EAAwCK,YAAxC,CAAqD,OAArD,EAA8D,eAA9D;AACA;AACD;AACD,SAASC,UAAT,CAAoBC,IAApB,EAA0B;AACzB;AACA,KAAIC,IAAID,KAAKE,QAAL,KAAkB,CAA1B;AACA,KAAIC,IAAIH,KAAKI,OAAL,EAAR;AACA,QACCJ,KAAKK,WAAL,KAAqB,GAArB,IAA4BJ,IAAI,EAAJ,GAAS,MAAMA,CAAf,GAAmBA,CAA/C,IAAoD,GAApD,IAA2DE,IAAI,EAAJ,GAAS,MAAMA,CAAf,GAAmBA,CAA9E,CADD;AAGA;;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA,IAAIf,MAAM,IAAIkB,GAAJ,CAAQ;AACjBC,KAAI,MADa;AAEjBC,OAAM;AACLC,UAAQ,EADH;AAELC,cAAY,IAAIC,IAAJ,EAFP;AAGLC,eAAa,IAHR;AAILC,aAAW,IAJN;AAKLxB,eAAa,EALR;AAMLyB,eAAa,EANR;AAOLC,cAAY,WAPP;AAQLC,WAAS,EARJ;AASLC,eAAa,EATR;AAULC,cAAY,EAVP;AAWLC,eAAa,EAXR;AAYLC,cAAY,KAZP;AAaLC,kBAAgB;AAbX,EAFW;AAiBjBC,UAAS;AACRC,cAAY,sBAAM;AACjB,aAAKR,UAAL,GAAkB,aAAlB;AACAS,SAAM1C,MAAN,EAAc;AACb2C,YAAQ,MADK;AAEbjB,UAAM;AACLkB,yFAEoCtC,IAAI4B,OAFxC,mBAE6D5B,IAAI6B,WAFjE,kBAEyF7B,IAAI8B,UAF7F;AADK,KAFO;AAWbS,aAAS,EAAC,iBAAiB,WAAWvC,IAAI+B,WAAjC;AAXI,IAAd,EAaES,IAbF,CAaO,kBAAU;AACfC,YAAQC,GAAR,CAAYC,MAAZ;AACA3C,QAAI2B,UAAJ,GAAiB,WAAjB;AACA3B,QAAIgC,UAAJ,GAAiB,IAAjB;AACAhC,QAAI6B,WAAJ,GAAkB,EAAlB;AACA7B,QAAI8B,UAAJ,GAAiB,EAAjB;AACA,IAnBF,EAoBEc,KApBF,CAoBQ,eAAO;AACbH,YAAQC,GAAR,CAAYG,GAAZ;AACA7C,QAAIgC,UAAJ,GAAiB,KAAjB;AACAhC,QAAI2B,UAAJ,GAAiB,WAAjB;AACA3B,QAAIiC,cAAJ,GAAqB,IAArB;AACA,IAzBF;AA0BA;AA7BO;AAjBQ,CAAR,CAAV;;AAkDA;AACA,IAAMa,QAAQ,IAAIvB,IAAJ,EAAd;AACA,IAAIwB,SAAS,IAAIC,OAAJ,CAAY;AACxBC,QAAO3C,SAASC,cAAT,CAAwB,YAAxB,CADiB;AAExB2C,OAAM;AACLC,iBAAgB,cADX;AAEFC,aAAgB,WAFd;AAGLC,UAASrE,QAHJ;AAILsE,YAAgBnE,UAJX;AAKFoE,iBAAgBtE;AALd,EAFkB;AASxBuE,WAAU,CATc;AAUxBC,UAASX,KAVe;AAWxBY,UAAS,IAAInC,IAAJ,CACRuB,MAAM7B,WAAN,KAAsB,CADd,EAER6B,MAAMhC,QAAN,EAFQ,EAGRgC,MAAM9B,OAAN,EAHQ,CAXe;AAgBxB2C,YAAW,CAACb,MAAM7B,WAAN,EAAD,EAAsB6B,MAAM7B,WAAN,KAAsB,CAA5C,CAhBa;AAiBxB2C,UAAS,mBAAM;AACd5D,MAAIsB,UAAJ,GAAiBhB,SAASC,cAAT,CAAwB,YAAxB,EAAsCsD,KAAvD;AACA7D,MAAIqB,MAAJ,GAAaV,WAAWoC,OAAO/B,OAAP,EAAX,CAAb;AACA,EApBuB;AAqBxB8C,SArBwB,oBAqBflD,IArBe,EAqBT;AACd,MAAMmD,MAAMnD,KAAKkD,QAAL,GAAgBE,KAAhB,CAAsB,GAAtB,EAA2B,CAA3B,CAAZ;AACA,MAAMC,QAAQrD,KAAKkD,QAAL,GAAgBE,KAAhB,CAAsB,GAAtB,EAA2B,CAA3B,CAAd;AACA,MAAME,UAAUtD,KAAKkD,QAAL,GAAgBE,KAAhB,CAAsB,GAAtB,EAA2B,CAA3B,CAAhB;AACA,MAAMG,eAAe,SAAfA,YAAe;AAAA,UAAWC,gBAAcH,KAAzB;AAAA,GAArB;AACA,MAAMI,iBAAiB,SAAjBA,cAAiB;AAAA,UAAWD,gBAAcF,OAAzB;AAAA,GAAvB;AACAlE,MAAIsB,UAAJ,GAAoBrC,WAAWE,WAAWmF,SAAX,CAAqBD,cAArB,CAAX,CAApB,SAA6EN,GAA7E,SAAyF/E,SAASE,SAASoF,SAAT,CAAmBH,YAAnB,CAAT,CAAzF;AACA,SAAUlF,WAAWE,WAAWmF,SAAX,CAAqBD,cAArB,CAAX,CAAV,SAAmEN,GAAnE,SAA+E/E,SAASE,SAASoF,SAAT,CAAmBH,YAAnB,CAAT,CAA/E;AACA;AA7BuB,CAAZ,CAAb;AA+BAnE,IAAIqB,MAAJ,GAAaV,WAAWoC,OAAO/B,OAAP,EAAX,CAAb,C,CAA2C;;AAE3C;AACA,IAAMuD,aAAa,SAAbA,UAAa,OAAQ;AAC1B,KAAIC,KAAKC,SAAShF,KAAKuE,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAT,CAAT;AACA,KAAIU,KAAKD,SAAShF,KAAKuE,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAT,CAAT;AACA,KAAIU,MAAM,CAAV,EAAa,OAAOtF,MAAMoF,KAAG,CAAT,EAAYhF,IAAnB,CAAb,KACK,OAAOJ,MAAMoF,KAAG,CAAH,GAAO,CAAb,EAAgBhF,IAAvB;AACL,CALD;AAMA,IAAImF,sBAAsB,IAA1B;;AAEAC,EAAE,YAAF,EAAgBC,eAAhB,CAAgC;AAC/BC,YAAW,EADoB;AAE/BC,WAAU,IAFqB;AAG/BC,UAAS,OAHsB;AAI/BC,UAAS,OAJsB;AAK/BC,WAAU,kBAACC,MAAD,EAASC,MAAT,EAAoB;AAC7B,MAAI3F,OAAO0F,OAAOnB,KAAP,CAAa,GAAb,CAAX;AACAhE,MAAIwB,WAAJ,GAAkB+C,WAAW9E,KAAK,CAAL,IAAU,GAAV,GAAgBA,KAAK,CAAL,CAA3B,CAAlB;AACA,MAAIkF,mBAAJ,EAAyB;AACxB,OAAIU,QAAQ5F,KAAK,CAAL,KAAW,IAAX,GAAkBA,KAAK,CAAL,CAAlB,GAA4B,EAAEA,KAAK,CAAL,CAA1C;AACA,OAAI6F,QAAQ7F,KAAK,CAAL,KAAW,IAAX,GAAkB,IAAlB,GAAyB,IAArC;AACAmF,KAAE,UAAF,EAAcW,GAAd,CAAkBF,QAAQ,GAAR,GAAcC,KAAhC;AACAtF,OAAIyB,SAAJ,GAAgB8C,WAAWc,QAAQ,GAAR,GAAcC,KAAzB,CAAhB;AACA;AACD,EAd8B;AAe/B1B,UAAS,mBAAM;AAACe,wBAAsB,KAAtB;AAA4B;AAfb,CAAhC;AAiBAC,EAAE,UAAF,EAAcC,eAAd,CAA8B;AAC7BC,YAAW,EADkB;AAE7BC,WAAU,IAFmB;AAG7BC,UAAS,OAHoB;AAI7BC,UAAS,OAJoB;AAK7BC,WAAU,kBAACC,MAAD,EAASC,MAAT,EAAoB;AAC7B,MAAI3F,OAAO0F,OAAOnB,KAAP,CAAa,GAAb,CAAX;AACAhE,MAAIyB,SAAJ,GAAgB8C,WAAW9E,KAAK,CAAL,IAAU,GAAV,GAAgBA,KAAK,CAAL,CAA3B,CAAhB;AACA,EAR4B;AAS7BmE,UAAS,mBAAM;AAACe,wBAAsB,KAAtB;AAA4B;AATf,CAA9B","file":"single-page.js","sourcesContent":["const monthsTH = ['ม.ค.','ก.พ.','มี.ค','เม.ย.','พ.ค.','มิ.ย','ก.ค.','ส.ค.','ก.ย.','ต.ค.','พ.ย.','ธ.ค.'];\nconst weekdaysTH = ['อา.','จ.','อ.','พ.','พฤ.','ศ.','ส.'];\nconst monthsEN = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\nconst weekdaysEN = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];\n\nconst times = [];\nfor (let t = 0, i = 0; t <= 23.5; t+=0.5, i++) times.push({slot: i, time: t});\n\nconst apiURL = \"https://api.space.itforge.io/graphql\";\n\nfunction findMin_Max() {\n\tmin_time = Math.min.apply(null, app.chosenTimes);\n\tmax_time = Math.max.apply(null, app.chosenTimes);\n}\nfunction setSelected () {\n\tfor (let j = min_time; j <= (max_time); j+=0.5) {\t\n\t\tdocument.getElementById(id=\"slot-\" + j).removeAttribute(\"class\");\n\t\tdocument.getElementById(id=\"slot-\" + j).setAttribute(\"class\", \"slot selected\");\n\t}\n}\nfunction setApiDate(date) {\n\t// create a raw date for sending to the API (eg. 2018-04-14)\n\tlet m = date.getMonth() + 1;\n\tlet d = date.getDate();\n\treturn (\n\t\tdate.getFullYear() + \"-\" + (m < 10 ? \"0\" + m : m) + \"-\" + (d < 10 ? \"0\" + d : d)\n\t);\n}\n\n/*Vue.component('time-slot', {\n\tprops: {\n\t\tavailable: Boolean,\n\t\tposition: Number,\n\t\tslotnum: Number\n\t},\n\ttemplate: '<span class=\"slot\" :class=\"{unavailable: !available, selected: isChosen}\" @click=\"choose\"><slot></slot></span>',\n\tdata: function () {\n\t\treturn {isChosen: false, isAvailable: this.available}\n\t},\n\tmethods: {\n\t\tchoose: () => {\n\t\t\tlet beSelected = document.getElementsByClassName(\"slot selected\");\n\t\t\tif (app.chosenTimes.length > 1) app.chosenTimes.length = 0;\n\t\t\tif (app.chosenSlots.length > 1) app.chosenSlots.length = 0;\n\t\t\twhile(beSelected.length >= 1) {\n\t\t\t\tfor (let i = 0; i < (beSelected.length); i+=1)\n\t\t\t\t\tbeSelected[i].setAttribute(\"class\", \"slot\");\n\t\t\t}\n\t\t\tif (this.isAvailable) {\n\t\t\t\tif (app.chosenTimes.includes(this.position)) {\n\t\t\t\t\tapp.chosenTimes.splice(app.chosenTimes.indexOf(this.position), 1);\n\t\t\t\t} else app.chosenTimes.push(this.position);\n\t\t\t\tif (app.chosenSlots.includes(this.slotnum)) {\n\t\t\t\t\tapp.chosenSlots.splice(app.chosenSlots.indexOf(this.slotnum), 1);\n\t\t\t\t} else app.chosenSlots.push(this.slotnum);\n\t\t\t} else {\n\t\t\t\tapp.chosenTimes.length = 0;\n\t\t\t\tapp.chosenSlots.length = 0;\n\t\t\t\tapp.startSlot = 0;\n\t\t\t\tapp.endSlot = 0;\n\t\t\t}\n\t\t\t// sub function psudoDrag\n\t\t\tfindMin_Max();\n\t\t\tsetSelected();\n\t\t}\n\t}\n});*/\n\nvar app = new Vue({\n\tel: '#app',\n\tdata: {\n\t\tr_date: \"\",\n\t\tr_date_raw: new Date(),\n\t\tr_startTime: \"18\",\n\t\tr_endTime: \"19\",\n\t\tchosenTimes: [],\n\t\tchosenSlots: [],\n\t\tsubmitText: \"ส่งรายงาน\",\n\t\tspaceId: \"\",\n\t\treportTitle: \"\",\n\t\treportBody: \"\",\n\t\treportToken: \"\",\n\t\treportSent: false,\n\t\tsubmitHasError: false\n\t},\n\tmethods: {\n\t\tsendReport: () => {\n\t\t\tthis.submitText = \"กำลังส่ง...\";\n\t\t\taxios(apiURL, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdata: {\n\t\t\t\t\tquery: `\n\t\t\t\t\t\tmutation {\n\t\t\t\t\t\t\tcreateProblem(input: {spaceId: \"${app.spaceId}\", title: \"${app.reportTitle}\", body: \"${app.reportBody}\"}) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t`\n\t\t\t\t},\n\t\t\t\theaders: {\"Authorization\": \"bearer\" + app.reportToken}\n\t\t\t})\n\t\t\t\t.then(result => {\n\t\t\t\t\tconsole.log(result);\n\t\t\t\t\tapp.submitText = \"ส่งรายงาน\";\n\t\t\t\t\tapp.reportSent = true;\n\t\t\t\t\tapp.reportTitle = \"\";\n\t\t\t\t\tapp.reportBody = \"\";\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\tapp.reportSent = false;\n\t\t\t\t\tapp.submitText = \"ส่งรายงาน\";\n\t\t\t\t\tapp.submitHasError = true;\n\t\t\t\t});\n\t\t}\n\t}\n});\n\n// Date picker\nconst today = new Date();\nvar picker = new Pikaday({\n\tfield: document.getElementById(\"datepicker\"),\n\ti18n: {\n\t\tpreviousMonth : 'เดือนที่แล้ว',\n    \tnextMonth     : 'เดือนหน้า',\n\t\tmonths : monthsTH,\n\t\tweekdays      : weekdaysEN,\n\t    weekdaysShort : weekdaysTH\n\t},\n\tfirstDay: 1,\n\tminDate: today,\n\tmaxDate: new Date(\n\t\ttoday.getFullYear() + 1,\n\t\ttoday.getMonth(),\n\t\ttoday.getDate()\n\t),\n\tyearRange: [today.getFullYear(), today.getFullYear() + 1],\n\tonClose: () => {\n\t\tapp.r_date_raw = document.getElementById(\"datepicker\").value;\n\t\tapp.r_date = setApiDate(picker.getDate());\n\t},\n\ttoString(date) {\n\t\tconst day = date.toString().split(\" \")[2];\n\t\tconst month = date.toString().split(\" \")[1];\n\t\tconst weekday = date.toString().split(\" \")[0];\n\t\tconst monthsMapper = element => element == `${month}`;\n\t\tconst weekdaysMapper = element => element == `${weekday}`;\n\t\tapp.r_date_raw = `${weekdaysTH[weekdaysEN.findIndex(weekdaysMapper)]}\\u0020${day}\\u0020${monthsTH[monthsEN.findIndex(monthsMapper)]}`;\n\t\treturn `${weekdaysTH[weekdaysEN.findIndex(weekdaysMapper)]}\\u0020${day}\\u0020${monthsTH[monthsEN.findIndex(monthsMapper)]}`;\n\t}\n});\napp.r_date = setApiDate(picker.getDate()); // initial to present\n\n// Time picker\nconst timeToSlot = time => {\n\tlet hr = parseInt(time.split(\":\")[0]);\n\tlet mn = parseInt(time.split(\":\")[1]);\n\tif (mn == 0) return times[hr*2].slot;\n\telse return times[hr*2 + 1].slot;\n}\nlet isFirstTimeChoosing = true;\n\n$(\"#timeStart\").clockTimePicker({\n\tprecision: 30,\n\trequired: true,\n\tminimum: \"09:00\",\n\tmaximum: \"19:30\",\n\tonAdjust: (newVal, oldVal) => {\n\t\tlet time = newVal.split(\":\");\n\t\tapp.r_startTime = timeToSlot(time[0] + \":\" + time[1]);\n\t\tif (isFirstTimeChoosing) {\n\t\t\tlet endHr = time[1] == \"00\" ? time[0] : ++time[0];\n\t\t\tlet endMn = time[1] == \"00\" ? \"30\" : \"00\";\n\t\t\t$(\"#timeEnd\").val(endHr + \":\" + endMn);\n\t\t\tapp.r_endTime = timeToSlot(endHr + \":\" + endMn);\n\t\t}\n\t},\n\tonClose: () => {isFirstTimeChoosing = false}\n});\n$(\"#timeEnd\").clockTimePicker({\n\tprecision: 30,\n\trequired: true,\n\tminimum: \"09:00\",\n\tmaximum: \"19:30\",\n\tonAdjust: (newVal, oldVal) => {\n\t\tlet time = newVal.split(\":\");\n\t\tapp.r_endTime = timeToSlot(time[0] + \":\" + time[1]);\n\t},\n\tonClose: () => {isFirstTimeChoosing = false}\n});\n"]}